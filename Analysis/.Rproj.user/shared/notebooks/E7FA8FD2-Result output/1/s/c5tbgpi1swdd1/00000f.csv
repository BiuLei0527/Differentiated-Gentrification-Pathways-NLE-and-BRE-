"0","library(dplyr)"
"0",""
"0","quick_summary <- function(data, dataset_name) {"
"0","  if(!exists(deparse(substitute(data)))) {"
"0","    return(NULL)}"
"0","  "
"0","  basic_info <- list(dataset = dataset_name,"
"0","    rows = nrow(data),"
"0","    cols = ncol(data),"
"0","    year_range = paste(min(data$year, na.rm = TRUE), ""-"", max(data$year, na.rm = TRUE)),"
"0","    lsoa_count = length(unique(data$LSOA11CD)))"
"0","  "
"0","  # Variable statistics"
"0","  numeric_vars <- c(""lsoa_income_estimate"", ""median_price"", ""crime rate"", ""mobility"")"
"0","  "
"0","  stats_list <- list()"
"0","  for(var in numeric_vars) {"
"0","    if(var %in% names(data)) {"
"0","      stats <- data %>%"
"0","        summarise("
"0","          Mean = round(mean(!!sym(var), na.rm = TRUE), 2),"
"0","          Median = round(median(!!sym(var), na.rm = TRUE), 2),"
"0","          SD = round(sd(!!sym(var), na.rm = TRUE), 2),"
"0","          Min = round(min(!!sym(var), na.rm = TRUE), 2),"
"0","          Max = round(max(!!sym(var), na.rm = TRUE), 2),"
"0","          NA_count = sum(is.na(!!sym(var))))"
"0","      stats_list[[var]] <- stats}}"
"0","  "
"0","  return(list(basic_info = basic_info, statistics = stats_list))}"
"0",""
"0","datasets <- list("
"0","  ""nle_matched_metrics"" = if(exists(""nle_matched_metrics"")) nle_matched_metrics else NULL,"
"0","  ""nle_affected_metrics"" = if(exists(""nle_affected_metrics"")) nle_affected_metrics else NULL,"
"0","  ""bre_matched_metrics"" = if(exists(""bre_matched_metrics"")) bre_matched_metrics else NULL,"
"0","  ""bre_affected_metrics"" = if(exists(""bre_affected_metrics"")) bre_affected_metrics else NULL)"
"0",""
"0","# Create comparison table"
"0","comparison_table <- data.frame("
"0","  Dataset = character(),"
"0","  Variable = character(),"
"0","  Mean = numeric(),"
"0","  Median = numeric(),"
"0","  SD = numeric(),"
"0","  Min = numeric(),"
"0","  Max = numeric(),"
"0","  stringsAsFactors = FALSE)"
"0",""
"0","numeric_vars <- c(""lsoa_income_estimate"", ""median_price"", ""crime rate"", ""mobility"")"
"0",""
"0","for(dataset_name in names(datasets)) {"
"0","  dataset <- datasets[[dataset_name]]"
"0","  "
"0","  if(!is.null(dataset)) {"
"0","    for(var in numeric_vars) {"
"0","      if(var %in% names(dataset)) {"
"0","        stats <- dataset %>%"
"0","          summarise("
"0","            Mean = round(mean(!!sym(var), na.rm = TRUE), 2),"
"0","            Median = round(median(!!sym(var), na.rm = TRUE), 2),"
"0","            SD = round(sd(!!sym(var), na.rm = TRUE), 2),"
"0","            Min = round(min(!!sym(var), na.rm = TRUE), 2),"
"0","            Max = round(max(!!sym(var), na.rm = TRUE), 2))"
"0","        "
"0","        comparison_table <- rbind(comparison_table, data.frame("
"0","          Dataset = dataset_name,"
"0","          Variable = var,"
"0","          Mean = stats$Mean,"
"0","          Median = stats$Median,"
"0","          SD = stats$SD,"
"0","          Min = stats$Min,"
"0","          Max = stats$Max))}}}}"
"0",""
"0","if(nrow(comparison_table) > 0) {"
"0","  print(comparison_table)"
"0","  write.csv(comparison_table, ""datasets_comparison.csv"", row.names = FALSE)}"
