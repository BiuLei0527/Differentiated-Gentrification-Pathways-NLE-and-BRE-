"0","variables_to_analyze <- c(""claimant_rate"", ""median_price"", ""population"", ""imd_interp"")"
"0",""
"0","calculate_descriptive_stats <- function(data, vars) {"
"0","  "
"0","  stats_df <- data.frame("
"0","    Variable = character(),"
"0","    Mean = numeric(),"
"0","    Median = numeric(),"
"0","    SD = numeric(),"
"0","    Min = numeric(),"
"0","    Max = numeric(),"
"0","    stringsAsFactors = FALSE)"
"0"," "
"0","  for (var in vars) {"
"0","    if (var %in% names(data)) {"
"0","      var_data <- data[[var]]"
"0","      var_data <- var_data[!is.na(var_data)]"
"0","      "
"0","      if (length(var_data) > 0) {"
"0","        stats_row <- data.frame("
"0","          Variable = var,"
"0","          Mean = round(mean(var_data, na.rm = TRUE), 2),"
"0","          Median = round(median(var_data, na.rm = TRUE), 2),"
"0","          SD = round(sd(var_data, na.rm = TRUE), 2),"
"0","          Min = round(min(var_data, na.rm = TRUE), 2),"
"0","          Max = round(max(var_data, na.rm = TRUE), 2)"
"0","        )"
"0","        stats_df <- rbind(stats_df, stats_row)"
"0","      } else {"
"0","        cat(paste(""Warning：Variable"", var, ""no valid data\n""))"
"0","      }"
"0","    } else {cat(paste(""Warning：Variable"", var, ""not exist\n""))}}"
"0","  "
"0","  return(stats_df)}"
"0",""
"0",""
"0","descriptive_stats <- calculate_descriptive_stats(combined_data_final_ver, variables_to_analyze)"
"0",""
"0","print(descriptive_stats, row.names = FALSE)"
