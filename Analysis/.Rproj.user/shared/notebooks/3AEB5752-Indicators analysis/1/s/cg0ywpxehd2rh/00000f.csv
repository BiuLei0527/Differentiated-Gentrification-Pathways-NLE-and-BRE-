"0","library(stringr)"
"0",""
"0","house_price_raw <- read_excel(""/Users/xilver/Desktop/CASA0004/Data/price paid data/median house price.xls"", sheet = ""1a"", skip = 5)"
"0",""
"0","house_price_london <- house_price_raw %>%"
"0","  filter(`LSOA code` %in% london_lsoas)"
"0",""
"0","target_cols <- c("
"0","  ""Year ending Mar 2011"", ""Year ending Jun 2011"", ""Year ending Sep 2011"", ""Year ending Dec 2011"","
"0","  ""Year ending Mar 2012"", ""Year ending Jun 2012"", ""Year ending Sep 2012"", ""Year ending Dec 2012"","
"0","  ""Year ending Mar 2013"", ""Year ending Jun 2013"", ""Year ending Sep 2013"", ""Year ending Dec 2013"","
"0","  ""Year ending Mar 2014"", ""Year ending Jun 2014"", ""Year ending Sep 2014"", ""Year ending Dec 2014"","
"0","  ""Year ending Mar 2015"", ""Year ending Jun 2015"", ""Year ending Sep 2015"", ""Year ending Dec 2015"","
"0","  ""Year ending Mar 2016"", ""Year ending Jun 2016"", ""Year ending Sep 2016"", ""Year ending Dec 2016"","
"0","  ""Year ending Mar 2017"", ""Year ending Jun 2017"", ""Year ending Sep 2017"", ""Year ending Dec 2017"","
"0","  ""Year ending Mar 2018"", ""Year ending Jun 2018"", ""Year ending Sep 2018"", ""Year ending Dec 2018"","
"0","  ""Year ending Mar 2019"", ""Year ending Jun 2019"", ""Year ending Sep 2019"", ""Year ending Dec 2019"","
"0","  ""Year ending Mar 2020"", ""Year ending Jun 2020"", ""Year ending Sep 2020"", ""Year ending Dec 2020"","
"0","  ""Year ending Mar 2021"", ""Year ending Jun 2021"", ""Year ending Sep 2021"", ""Year ending Dec 2021"","
"0","  ""Year ending Mar 2022"", ""Year ending Jun 2022"", ""Year ending Sep 2022"", ""Year ending Dec 2022"")"
"0",""
"0","id_cols <- c(""LSOA code"", ""LSOA name"") "
"0",""
"0","house_price_filtered <- house_price_london %>%"
"0","  dplyr::select(all_of(c(id_cols, target_cols)))"
"0",""
"0","house_price_long <- house_price_filtered %>%"
"0","  pivot_longer(cols = starts_with(""Year ending""),"
"0","    names_to = ""period"","
"0","    values_to = ""median_price"")"
"0",""
"0","house_price_long <- house_price_long %>%"
"0","  mutate(quarter_month = str_extract(period, ""(?<=Year ending )\\w+""),"
"0","    year = str_extract(period, ""\\d{4}""),"
"0","    quarter = recode(quarter_month, ""Mar"" = ""Q1"", ""Jun"" = ""Q2"", ""Sep"" = ""Q3"", ""Dec"" = ""Q4""),"
"0","    quarter_label = paste0(year, ""-"", quarter))"
"0",""
"0","house_price_long$median_price <- gsub("","", """", house_price_long$median_price)"
"0","house_price_long$median_price <- gsub(""Â£"", """", house_price_long$median_price)"
"0","house_price_long$median_price <- as.numeric(house_price_long$median_price)"
"2","Warning: NAs introduced by coercion"
"0","house_price_long <- house_price_long %>%"
"0","  mutate(year = str_extract(period, ""\\d{4}"")) %>%"
"0","  group_by(`LSOA code`, `LSOA name`, year) %>%"
"0","  summarise(median_price = median(median_price, na.rm = TRUE), .groups = ""drop"")"
"0",""
