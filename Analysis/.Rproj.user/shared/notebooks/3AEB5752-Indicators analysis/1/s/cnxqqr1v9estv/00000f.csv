"0","imd_2004_2007 <- read_csv(""/Users/xilver/Desktop/CASA0004/Data/imd/2004_imd.csv"") %>%
  dplyr::select(`LSOA`, `GOR NAME`, `2004IMD SCORE`, `2007IMD SCORE`) %>%
  filter(`GOR NAME` == ""London"")
"
"2","[1mRows: [22m[34m32482[39m [1mColumns: [22m[34m53[39m"
"2","[36mâ”€â”€[39m [1mColumn specification[22m [36mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[1mDelimiter:[22m "",""
[31mchr[39m  (5): LSOA, LA CODE, LA NAME, GOR CODE, GOR NAME
[32mdbl[39m (48): 2004IMD SCORE, 2004RANK OF IMD (where 1 is most deprived), 2004INCOME SCORE, 2004RANK O..."
"2","
[36mâ„¹[39m Use `spec()` to retrieve the full column specification for this data.
[36mâ„¹[39m Specify the column types or set `show_col_types = FALSE` to quiet this message."
"0","imd_2010 <- read_csv(""/Users/xilver/Desktop/CASA0004/Data/imd/2010_imd.csv"") %>%"
"0","  dplyr::select(`LSOA code (2011)`, `2010IMD adjusted`, `2015Index of Multiple Deprivation (IMD) Score`) "
"2","[1mRows: [22m[34m32844[39m [1mColumns: [22m[34m61[39m"
"2","[36mâ”€â”€[39m [1mColumn specification[22m [36mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[1mDelimiter:[22m "",""
[31mchr[39m  (4): LSOA code (2011), LSOA name (2011), Local Authority District code (2013), Local Authori...
[32mdbl[39m (57): 2010IMD adjusted, 2010National quintile1, 2010National decile2, 2010imd_rank, 2015Index..."
"2","
[36mâ„¹[39m Use `spec()` to retrieve the full column specification for this data.
[36mâ„¹[39m Specify the column types or set `show_col_types = FALSE` to quiet this message."
"0","imd_2010_london <- imd_2010 %>%"
"0","  filter(`LSOA code (2011)` %in% london_lsoas)"
"0",""
"0","imd_2019_london <- read_excel(""/Users/xilver/Desktop/CASA0004/Data/imd/2019_imd.xlsx"", sheet = ""IMD 2019"") %>%"
"0","  dplyr::select(`LSOA code (2011)`, `LSOA name (2011)`, `Index of Multiple Deprivation (IMD) Score`) %>%"
"0","  filter(`LSOA code (2011)` %in% london_lsoas)"
"0",""
"0","lookup_2001 <- read_csv(""/Users/xilver/Downloads/2001_lookup.csv"") %>%"
"0","  dplyr::select(`LSOA01CD`,	`LSOA11CD`)"
"2","[1mRows: [22m[34m34917[39m [1mColumns: [22m[34m9[39m"
"2","[36mâ”€â”€[39m [1mColumn specification[22m [36mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[39m
[1mDelimiter:[22m "",""
[31mchr[39m (8): LSOA01CD, LSOA01NM, LSOA11CD, LSOA11NM, CHGIND, LAD11CD, LAD11NM, LAD11NMW
[32mdbl[39m (1): FID"
"2","
[36mâ„¹[39m Use `spec()` to retrieve the full column specification for this data.
[36mâ„¹[39m Specify the column types or set `show_col_types = FALSE` to quiet this message."
"0","lookup_2001_geo <- st_read(""/Users/xilver/Downloads/2001_lookup.geojson"") %>%"
"0","  dplyr::select(`LSOA01CD`,	`LSOA11CD`)"
"1","Reading layer `"
"1","Lower_Layer_Super_Output_Area_(2001)_to_Lower_Layer_Super_Output_Area_(2011)_to_Local_Authority_District_(2011)_Lookup_in_England_and_Wales"
"1","' from data source "
"1","`"
"1","/Users/xilver/Downloads/2001_lookup.geojson"
"1","' "
"1","using driver `"
"1","GeoJSON"
"1","'"
"1","
"
"1","replacing null geometries with empty geometries"
"1","
"
"1","Simple feature collection with 34917 features and 9 fields"
"1"," (with 34917 geometries empty)"
"1","
"
"1","Geometry type: GEOMETRYCOLLECTION
"
"1","Dimension:     XY
"
"1","Bounding box:  "
"1","xmin: NA ymin: NA xmax: NA ymax: NA"
"1","
"
"1","Geodetic CRS:  WGS 84
"
"0","geo_2001 <- lookup_2001_geo %>%"
"0","  filter(`LSOA11CD` %in% london_lsoas)"
"0",""
"0","imd_mapped_2004 <- imd_2004_2007 %>%"
"0","  left_join(lookup_2001, by = c(""LSOA"" = ""LSOA01CD"")) %>%"
"0","  group_by(LSOA11CD) %>%"
"0","  summarise(imd2004 = mean(`2004IMD SCORE`),"
"0","    imd2007 = mean(`2007IMD SCORE`))"
"0",""
"0","imd_2010_london <- imd_2010_london %>%"
"0","  rename(LSOA11CD = `LSOA code (2011)`) %>%"
"0","  dplyr::select(LSOA11CD, imd2010 = `2010IMD adjusted`, imd2015 = `2015Index of Multiple Deprivation (IMD) Score`)"
"0",""
"0","imd_2019_london <- imd_2019_london %>%"
"0","  rename(LSOA11CD = `LSOA code (2011)`,"
"0","         imd2019 = `Index of Multiple Deprivation (IMD) Score`) %>%"
"0","  dplyr::select(LSOA11CD, imd2019)"
"0",""
"0","imd_all <- imd_mapped_2004 %>%"
"0","  full_join(imd_2010_london, by = ""LSOA11CD"") %>%"
"0","  full_join(imd_2019_london, by = ""LSOA11CD"")"
"0",""
"0","imd_long <- imd_all %>%"
"0","  pivot_longer("
"0","    cols = starts_with(""imd""),"
"0","    names_to = ""year"","
"0","    values_to = ""imd_score"") %>%"
"0","  mutate(year = gsub(""imd"", """", year)) %>%"
"0","  arrange(LSOA11CD, year)"
"0",""
"0","all_years <- seq(2010, 2022, by = 1)"
"0",""
"0","imd_data <- imd_all %>%"
"0","  dplyr::select(LSOA11CD, imd2010, imd2015, imd2019) %>%"
"0","  pivot_longer(cols = starts_with(""imd""), names_to = ""year"", values_to = ""imd"") %>%"
"0","  mutate(year = case_when(year == ""imd2010"" ~ 2010,"
"0","    year == ""imd2015"" ~ 2015,"
"0","    year == ""imd2019"" ~ 2019))"
"0",""
"0","imd_interp <- imd_data %>%"
"0","  group_by(LSOA11CD) %>%"
"0","  complete(year = all_years) %>%"
"0","  arrange(LSOA11CD, year) %>%"
"0","  mutate(imd_interp = na.approx(imd, x = year, na.rm = FALSE, rule=2)) %>%"
"0","  ungroup() %>%"
"0","  dplyr::select(-imd)"
